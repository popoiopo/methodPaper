<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-05-24 Sun 17:49 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Idea for Methodpaper example</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Bas Chatel" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Idea for Methodpaper example</h1>
<div id="outline-container-orgbae51cd" class="outline-2">
<h2 id="orgbae51cd">Photohabditus Aminogaster</h2>
<div class="outline-text-2" id="text-orgbae51cd">
</div>
<div id="outline-container-org4e2a707" class="outline-3">
<h3 id="org4e2a707">Funfact</h3>
<div class="outline-text-3" id="text-org4e2a707">
<p>
The Photohabditus Aminogaster is named after two of the most influential animals in genetics, the Caenorhabditis Elegans and the Drosophila Melanogaster.
</p>
</div>
</div>

<div id="outline-container-orgcd44af6" class="outline-3">
<h3 id="orgcd44af6">Introduction of the example</h3>
<div class="outline-text-3" id="text-orgcd44af6">
<p>
Imagine a type of worm that is photosensitive for protein expression in protein X. A team of researchers are interested in how light effects not only this protein, but also it's effect on protein Y and Z through the excitatory or inhibitory effects of protein X. The causal diagram is as in figure <a href="#fig:cdpa">fig:cdpa</a>. Here we see that protein transcription has a positive relation with light, negative with itself and Y also has a positive relation with X. X has a negative relation with Y, while Z has a positive relation with Y. Y has a negative relation with Z and so does X. In terms of functional forms, the team of experts have knowledge about most links, but not all. The equations are described as follows:
</p>

\begin{align}
    x  &= x \cdot E_{light}\\
    dx &= y - x_{u1}\\
    dy &= -x + \alpha z\\
    dz &= -y - x_{u2}
\end{align}

<p>
In the equations above we see that x has an effect of light (\(E_{light}\)) so that x is multiplied by a value dependent on the absence or presence of light. Furthermore, we can see that there is an \(\alpha\) in the equation for \(dy\). This is a constant that, just as the effect of light, needs to be fitted in order to find an appropriate value. Lastly, there are two links of which the functional form is unknown or is known with a high degree of uncertainty (\(x_{u1}, x_{u2}\)). The functional forms of these links also need to be fitted. The rest of the links have a linear relationship.
</p>

<p>
The goal of the researchers is to find the model that is responsible for the dynamics of the three proteins. Now that the groundwork for the conceptual model is laid, data is needed to test the model and its uncertainties. Then by testing different possibilities the real underlying system can be retrieved.
</p>


<div id="org051600d" class="figure">
<p><img src="tiny_model.png" alt="tiny_model.png" />
</p>
<p><span class="figure-number">Figure 1: </span>Protein transcription causal diagram of Photohabditus Aminogaster.</p>
</div>
</div>
</div>

<div id="outline-container-org5d1e8bd" class="outline-3">
<h3 id="org5d1e8bd">The data</h3>
<div class="outline-text-3" id="text-org5d1e8bd">
<p>
The scientists go on and measure transcription over time of all three proteins while introducing no light (see figure <a href="#fig:nolightmv">fig:nolightmv</a>) and with light introduction (see figure <a href="#fig:proteinsmv">fig:proteinsmv</a>). The measurement method has introduced some error margin and also around 50% of measurements are missing seem to be missing.
</p>

<div class="org-center">

<div id="org55e9f56" class="figure">
<p><img src="proteins_no_light_mv.png" alt="proteins_no_light_mv.png" />
</p>
</div>

<div id="orgcc21ffe" class="figure">
<p><img src="proteins_mv.png" alt="proteins_mv.png" />
</p>
</div>
</div>
</div>
</div>


<div id="outline-container-org94f871f" class="outline-3">
<h3 id="org94f871f">Fitting the functional form</h3>
<div class="outline-text-3" id="text-org94f871f">
<p>
To fit the functional form of a link between two variables one can make use of genetic programming. The idea is to define a set of possible functional forms and apply these to the network in a random way. By doing so, we can sample the possibilities and search for a best fit. In our example, the functional forms for links \(x_{u1}\) and \(x_{u2}\) are unknown. The set of possible functional forms that we will use is {linear, quadratic, cubic, sigmoid}. These forms are viewed in the following equations in their mathematical form. 
</p>

\begin{align}
x_u &= x\\
&= x^2\\
&= x^3\\
&= \frac{x}{\sqrt{1 + x^2}}
\end{align}

<p>
The functional forms can be fitted in several ways. Genetic programming is often used for these types of problems. The idea is to create a population of different answers to the problem and check how well each answer performs. Then the answers are crossbred and mutated due to some selection processes of which the results will be the next generation of population of answers. These will again be evaluated on performance and so on until a predefined number of generations has been hit or the best answer has performed better then some minimal error that is also predefined.
</p>

<p>
During each evaluation of a possible functional form, the unknown parameters need to be fitted as well. Here we can, for example, make use of simulated annealing. For simplicity, we will elaborate on the hillclimber algorithm, which is a simpler version of simulated annealing. The idea is that a random value is sampled for a parameter and then the performance is evaluated. Then the value will be nudged a bit in a random direction, and this value will be evaluated for performance as well. If the performance is better, the new value is accepted to be the better solution. Otherwise, if the new value performs worse, it is not accepted. This way, we optimize the parameter value for fitness.
</p>

<p>
For example, if we take the following three sets of functional forms:
</p>

<p>
\(1^{st}\):
</p>
\begin{align}
x_{u1} &= -x^3\\
x_{u2} &= -\frac{x}{\sqrt{1 + x^2}}
\end{align}
<p>
\(2^{nd}\):
</p>
\begin{align}
x_{u1} &= -x\\
x_{u2} &= -x
\end{align}
<p>
\(3^{rd}\):
</p>
\begin{align}
x_{u1} &= -\frac{x}{\sqrt{1 + x^2}}\\
x_{u2} &= -x**3
\end{align}

<p>
These different forms have different dynamics, but still need to be fitted. In the coming figures we see these networks in the same order with the effect of light equal to the effect of dark (\(E_{light}=1\) for both light and dark). Also \(\alpha = 1\).
</p>

<div class="org-center">

<div class="figure">
<p><img src="proteins_deriv1_no_fit.png" alt="proteins_deriv1_no_fit.png" />
</p>
</div>

<div class="figure">
<p><img src="proteins_deriv2_no_fit.png" alt="proteins_deriv2_no_fit.png" />
</p>
</div>

<div class="figure">
<p><img src="proteins_deriv3_no_fit.png" alt="proteins_deriv3_no_fit.png" />
</p>
</div>
</div>

<p>
With fitting the data we find that the optimal values for the effect of light and \(alpha\) are 1 and 0.5 for the first model, 0.7 and 0.7 for the second model and 0.6 and 0.8 for the last model. The cost function chosen here is the mean absolute error that has a value of 0, 0.37 and 0.56 respectively.
</p>

<div class="org-center">

<div class="figure">
<p><img src="proteins_deriv1_hillc_no_light.png" alt="proteins_deriv1_hillc_no_light.png" />
</p>
</div>

<div class="figure">
<p><img src="proteins_deriv2_hillc_no_light.png" alt="proteins_deriv2_hillc_no_light.png" />
</p>
</div>

<div class="figure">
<p><img src="proteins_deriv3_hillc_no_light.png" alt="proteins_deriv3_hillc_no_light.png" />
</p>
</div>
</div>

<p>
For the dark condition, it seems that the model is as follows: 
</p>

\begin{align}
    x  &= x \cdot E_{light}\\
    dx &= y - x^3\\
    dy &= -x + 0.5z\\
    dz &= -y - \frac{x}{\sqrt{1 + x^2}}
\end{align}

<p>
However, we have not yet found the model in the light condition. By applying the same process for the dark condition on all three models we get the following figures.
</p>

<div class="org-center">

<div class="figure">
<p><img src="proteins_deriv1_hillc_light.png" alt="proteins_deriv1_hillc_light.png" />
</p>
</div>

<div class="figure">
<p><img src="proteins_deriv2_hillc_light.png" alt="proteins_deriv2_hillc_light.png" />
</p>
</div>

<div class="figure">
<p><img src="proteins_deriv3_hillc_light.png" alt="proteins_deriv3_hillc_light.png" />
</p>
</div>
</div>

<p>
Here we find that the optimal values for the light parameter and \(\alpha\) are 0.3 and 0.5 for the first model, 0.2 and 0.6 for the second model and 0.0 and 0.8 for the last model. With mean absolute error values 0.0, 0.91, and 1.22 respectively.
</p>
</div>
</div>
</div>

<div id="outline-container-org7d87cb6" class="outline-2">
<h2 id="org7d87cb6">Final model</h2>
<div class="outline-text-2" id="text-org7d87cb6">
<p>
The final model of the system is as follows:
</p>

\begin{align}
    x  &= x \cdot E_{light}\\
    dx &= y - x^3\\
    dy &= -x + 0.5z\\
    dz &= -y - \frac{x}{\sqrt{1 + x^2}}
\end{align}

<p>
Where \(E_{light}\) is either 1 when the lights are off, and 0.3 when they are on. Running this model provides us with the closest approximation of the data, see figures TODO.
</p>

<div class="org-center">

<div class="figure">
<p><img src="proteins_no_light.png" alt="proteins_no_light.png" />
</p>
</div>

<div class="figure">
<p><img src="proteins.png" alt="proteins.png" />
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Bas Chatel (<a href="mailto:bas.chatel@radboudumc.nl">bas.chatel@radboudumc.nl</a>)</p>
<p class="date">Date wekrkt dit dan?!?!?! aaaah: </p>
<p class="creator"><a href="https://www.gnu.org/software/emacs/">Emacs</a> 26.3 (<a href="https://orgmode.org">Org</a> mode 9.3.6)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
